"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function getModules(){return{services:angular.module("services",[]),auth:angular.module("auth",[]),popup:angular.module("popup",[]),advert:angular.module("advert",[]),advertiser:angular.module("advertiser",[]),profile:angular.module("profile",[]),app:angular.module("app",["services","auth","popup","advert","advertiser","profile"])}}function advertServicesInit(e){e.factory("adverts",["$http",function(e){var t=function(e){var t={},r="/api/advert";switch(e.type){case"get":t.method="get",t.url=r+"/"+e._id;break;case"getAll":t.method="get",t.url=r;break;case"update":t.method="put",t.url=r+"/"+e._id;break;case"create":t.method="post",t.url=""+r;break;case"remove":t.method="get",t.url=r+"/"+e._id+"/delete"}return e.requestData&&(t.data=e.requestData),t},r=function(r){var a=t(r);return e(a)},a=function(e){return r({type:"get",_id:e})},n=function(){return r({type:"getAll"})},o=function(e){return r({type:"create",requestData:e})},i=function(e,t){return r({type:"update",_id:e,requestData:t})},s=function(e){return r({type:"remove",_id:e})};return{get:a,getAll:n,create:o,update:i,remove:s}}])}function advertiserServicesInit(e){e.factory("advertiser",["$http",function(e){var t=function(e){var t={},r="/api/advertiser";switch(e.type){case"get":break;case"update":break;case"remove":t.method="GET",t.url=r+"/"+e.id+"/delete"}return e.bodyData&&(t.data=e.bodyData),t},r=function(r){var a=t(r);return e(a)},a=function(){},n=function(){},o=function(e){return r({type:"remove",id:e})},i=function(){};return{get:a,save:n,remove:o,update:i}}])}function apiGenServicesInit(e){e.factory("api",["$http",function(e){var t={api_base:"",url:""},r={},a=function(r,a){r=r.toUpperCase(),a.url=a.url||t.url;var n={method:r,url:""+t.api_base+a.url};return function(t){for(var a in t)t.hasOwnProperty(a)&&("data"!==a?n.url=n.url.replace(":"+a,t[a]):"GET"!==r&&(n.data=t[a]));return e(n)}},n=function(e){for(var n in e.options)e.options.hasOwnProperty(n)&&(t[n]=e.options[n]);for(var o in e.calls)if(e.calls.hasOwnProperty(o))for(var i in e.calls[o])e.calls[o].hasOwnProperty(i)&&(r[i]=a(o,e.calls[o][i]));return r};return{generate:n}}])}function authServicesInit(e){e.factory("authService",["$http",function(e){var t=function(e,t){var r={};switch(e){case"login":r.method="POST",r.url="/auth/login";break;case"registration":r.method="POST",r.url="/auth";break;case"logout":r.method="GET",r.url="/auth/logout"}return t&&(r.data=t),r},r=function(r,a){var n=t(r,a);return new Promise(function(t,r){e(n).then(function(e){t(e)})["catch"](function(e){r(e)})})};return{authenticate:r}}])}function advertDirectivesInit(e){var t="/assets/templates";e.directive("advertsFeed",[function(){return{restrict:"A",templateUrl:t+"/adverts-feed.html",scope:{user_id:"@advertsFeed",filter_enabled:"=enableFilter"},controller:"advertsFeedCtrl",controllerAs:"feed"}}]),e.directive("advertsFilter",[function(){return{restrict:"AE",templateUrl:t+"/adverts-filter.html",scope:{filter_fields:"=feedFilter"},controller:"advertsFeedFilterCtrl",controllerAs:"filter"}}]),e.directive("advert",[function(){return{restrict:"A",templateUrl:t+"/advert.html",scope:{advert:"="}}}]),e.directive("advertSingle",[function(){return{restrict:"A",templateUrl:t+"/edit-advert.html",scope:{advert_id:"@advertSingle"},controller:"editAdvertCtrl",controllerAs:"advertEditor"}}])}function popupDirectivesInit(e){var t="/assets/templates";e.directive("popup",["$http",function(e){return{restrict:"A",transclude:{trigger:"popupTrigger",content:"popupContent"},templateUrl:t+"/popup.html",scope:{type:"@"},controller:"popupCtrl",controllerAs:"popup"}}])}function advertControllersInit(e){var t="/api/:schema",r="advert";e.controller("advertsFeedCtrl",["$http","$scope","api",function(e,a,n){var o=this,i=n.generate({options:{api_base:t},calls:{get:{one:{url:"/:id"},all:{},user:{url:"/:user_id/adverts"}}}});this.order="-publicationDate",this.getAdverts=function(e){e?i.user({user_id:e,schema:"advertiser"}).then(function(e){e.data.adverts&&(o.adverts=e.data.adverts)})["catch"](function(e){console.log(e)}):i.all({schema:r}).then(function(e){e.data.adverts&&(o.adverts=e.data.adverts)})["catch"](function(e){console.log(e)})},this.getAdverts(a.user_id)}]),e.controller("advertsFeedFilterCtrl",[function(){this.defaults={gender:"",type:""}}]),e.controller("newAdvertCtrl",["api",function(e){var a=this,n=e.generate({options:{api_base:t},calls:{post:{create:{}}}});this.advert={gender:"boy",type:"dog",age:1},this.create=function(){n.create({schema:r,data:a.advert}).then(function(e){e.data.success&&(document.location.href="/advert/"+e.data.advert._id)})["catch"](function(e){console.log(e)})}}]),e.controller("editAdvertCtrl",["$scope","api",function(e,a){var n=this,o=a.generate({options:{api_base:t},calls:{get:{get:{url:"/:id"}},put:{update:{url:"/:id"}}}}),i={};this.save=function(){o.update({schema:r,id:e.advert_id,data:n.advert}).then(function(e){e.data.success&&e.data.advert&&(n.advert=e.data.advert,n.advert.age&&(n.advert.age=parseInt(n.advert.age)),i=JSON.parse(JSON.stringify(n.advert)))})["catch"](function(e){console.log(e)})},this.reset=function(){n.advert=JSON.parse(JSON.stringify(i))},o.get({schema:r,id:e.advert_id}).then(function(e){e.data.success&&e.data.advert&&(n.advert=e.data.advert,n.advert.age&&(n.advert.age=parseInt(n.advert.age)),i=JSON.parse(JSON.stringify(n.advert)))})["catch"](function(e){console.log(e)})}]),e.controller("advertRemoveCtrl",["$scope","api",function(e,a){var n=a.generate({options:{api_base:t},calls:{get:{remove:{url:"/:id/delete"}}}});this.remove=function(e){n.remove({id:e,schema:r}).then(function(e){e.data.success&&e.data.redirect?document.location.href=e.data.redirect:e.data.message&&console.log(e.data)})["catch"](function(e){console.log(e)})},this.cancel=function(){e.$parent.$parent.popup.active=!1}}])}function advertiserControllersInit(e){e.controller("advertiserRemoveCtrl",["advertiser","$scope",function(e,t){this.remove=function(t){e.remove(t).then(function(e){e.data.success&&(document.location.href="/")})["catch"](function(e){console.log(e)})},this.cancel=function(){t.$parent.$parent.popup.active=!1}}])}function authControllersInit(e){e.controller("authCtrl",["$scope","$timeout","authService",function(e,t,r){var a=this;this.emailRegex=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,this.passwordRegex=/.*\S.*/,this.checkForm=function(t){a.error=!e[t].$valid,a.validClass=e[t].$valid?"valid":"error"},this.submit=function(n){e[n].email.$setTouched(),e[n].password.$setTouched(),e[n].$valid?r.authenticate(n,{email:a.email,password:a.password}).then(function(r){r.data.success?t(function(){a.responseClass="success",document.location.reload()},2e3):(console.log(e[n]+": failed"),console.log(r))})["catch"](function(e){e.data.success?console.log(e):(t(function(){a.responseClass="fail"},500),console.log(e.data.message))}):console.log(e[n]+" form invalid")},this.reset=function(){a.error=!1,a.validClass="",a.responseClass=""}}]),e.controller("logoutCtrl",["authService",function(e){this.logout=function(){e.authenticate("logout").then(function(e){e.data.success?document.location.reload():console.log(e.data.message)})["catch"](function(e){console.log(e)})}}])}function popupControllersInit(e){e.controller("popupCtrl",[function(){this.active=!1}])}function profileControllersInit(e){e.controller("profileSettingsCtrl",["advertiser",function(e){}])}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),Portfolio=function(){function e(t){_classCallCheck(this,e),this.modules=t}return _createClass(e,[{key:"initComponents",value:function(e,t){for(var r=0;r<t.length;r++)t[r](this.modules[e])}},{key:"init",value:function(e){for(var t in e)e.hasOwnProperty(t)&&this.initComponents(t,e[t])}}]),e}(),modules=getModules(),components={services:[apiGenServicesInit,authServicesInit,advertiserServicesInit,advertServicesInit],auth:[authControllersInit],popup:[popupControllersInit,popupDirectivesInit],advert:[advertControllersInit,advertDirectivesInit],advertiser:[advertiserControllersInit],profile:[profileControllersInit]},portfolio=new Portfolio(modules);portfolio.init(components);null//# sourceMappingURL=main.js.mapnull